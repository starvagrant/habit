<!DOCTYPE html>
<html lang="en-us">
<head>
	<meta charset="utf-8">
	<title>habits.php</title>
	<link rel="stylesheet" href="habit-form.css" /> 
</head>
<body>
<div id="page">
	<h1 id="header">List</h1>
	<h2>Learn Habits</h2>
	<form id="habit-complete" action='habit-complete.php' method="post"> 
		<ul id="completion">
<!-- putting top four habit items up front -->
			<li>
				Habit<span class="float-right">Complete? Priority?</span>
			</li>
			<li>
				<label>Habit:<input type="text" name="habit0" value = "do dishes"/>
					<input type="checkbox" name="complete0" value="completed" />
					<input type="checkbox" name="priority0" value="priority" checked="checked" />
				</label>
				<label><input type="hidden" name="score0" value="-8"/></label>
			</li>	
			<li>
				<label>Habit:<input type="text" name="habit1" value = "do dishes"/>
					<input type="checkbox" name="complete1" value="completed" />
					<input type="checkbox" name="priority1" value="priority" checked="checked" />
				</label>
				<label><input type="hidden" name="score1" value="-12"/></label>
			</li>
			<li>
				<label>Habit:<input type="text" name="habit2" value = "morning clean"/>
					<input type="checkbox" name="complete2" value="completed" />
					<input type="checkbox" name="priority2" value="priority" checked="checked" />
				</label>
				<label><input type="hidden" name="score2" value="1200" /></label>
			</li>	
			<li>
				<label>Habit:<input type="text" name="habit3" value = "morning clean"/>
					<input type="checkbox" name="complete3" value="completed" />
					<input type="checkbox" name="priority3" value="priority" checked="checked" />
				</label>
				<label><input type="hidden" name="score3" value="1200" /></label>
			</li>
			<li>
				<label>Habit:<input type="text" name="habit4" value = "morning clean"/>
					<input type="checkbox" name="complete4" value="completed" />
					<input type="checkbox" name="priority4" value="priority" checked="checked" />
				</label>
				<label><input type="hidden" name="score4" value="1200" /></label>
			</li>
			<li>
				<label>Habit:<input type="text" name="habit5" value = "morning clean"/>
					<input type="checkbox" name="complete5" value="completed" />
					<input type="checkbox" name="priority5" value="priority" checked="checked" />
				</label>
				<label><input type="hidden" name="score5" value="1200" /></label>
			</li>
			<li>
				<label>Habit:<input type="text" name="habit6" value = "morning clean"/>
					<input type="checkbox" name="complete6" value="completed" />
					<input type="checkbox" name="priority6" value="priority" checked="checked" />
				</label>
				<label><input type="hidden" name="score6" value="1200" /></label>
			</li>	
			<li>
				<label>Habit:<input type="text" name="habit7" value = "morning clean"/>
					<input type="checkbox" name="complete7" value="completed" />
					<input type="checkbox" name="priority7" value="priority" checked="checked" />
				</label>
				<label><input type="hidden" name="score7" value="1200" /></label>
			</li>
			<li>
				<label>Habit:<input type="text" name="habit8" value = "check refrigerat"/>
					<input type="checkbox" name="complete8" value="completed" />
					<input type="checkbox" name="priority8" value="priority" checked="checked" />
				</label>
				<label><input type="hidden" name="score8" value="0"/></label>
			</li>
			<li>
				<label>Habit:<input type="text" name="habit9" value = "budget"/>
					<input type="checkbox" name="complete9" value="completed" />
					<input type="checkbox" name="priority9" value="priority" checked="checked" />
				</label>
				<label><input type="hidden" name="score9" value="0"/></label>
			</li>
			<li>	<button type="submit">Submit</button>
			</li>		
		</ul>
	</form>
</div>
<script src="jquery-1.11.0.js"></script>


<script>
	var serializedData;
	var $form = $('form#habit.complete');
	
	$form.on('submit', this, serializedData, function(event) {
		console.log("where's my error? 0");
		var request;
		var dataForAjax = event.data;	
		var whatIsThis = this;
	
		if (request) { request.abort(); console.log("where's my error? 1"); } // abort if request is already present 	

		// serialized data passed through function call
		request = $.ajax({
			url: "habit-complete.php",
			type: "post",
			data: dataForAjax
		});

		if (request) { console.log("where's my error? 2"); } // abort if request is already present 	

		// curious as to what these are	
		request.done(function(response, textStatus, jqueryXHR) {
			/*
			console.log(response);
			console.log(textStatus);
			console.log(jqueryXHR);
			*/
			console.log("where's my error? 3"); 
			console.log('success');
			console.log(this);
			console.log(whatIsThis);
		});

		request.fail(function(response, textStatus, jqueryXHR) {
			console.log("where's my error? 4"); 
			console.log('fail');
			console.log(this);
			console.log(whatIsThis);
		});

		// prevent form submission
		e.preventDefault();
		console.log("where's my error? 4"); 
	});

	$checkboxes = $('input[type=checkbox]');
	$checkboxes.on('change', function(e){ 
		console.log('yoyoyo');
		$(this).parent().parent().hide(); 
		// put data in serialized string
		serializedData = $(this).siblings().serialize( "input" );
		console.log(serializedData);
		if( $form.submit(serializedData) ) {
			console.log('submitted');
		} else {
			console.log('failed');
		}
	});

</script>
<!--    <script src="js/basic-example.js"></script> -->
</body>
